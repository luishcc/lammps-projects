# Script modified from mDPD example folder
#
# Break up of fluid thread

units 		          lj
dimension	          3
boundary	          p p p
neighbor	          0.3 bin
neigh_modify        every 1 check yes

processors 2 2 *

atom_style	        mdpd



region     mdpd      block -100 100 -100 100 -20 20 units box
create_box          1 mdpd

lattice             fcc 6.
region     tube     block -100 100 -100 100 -2 2 units box
create_atoms        1 region tube

pair_style          hybrid/overlay mdpd/rhosum mdpd 1.0 1.0 20055
pair_coeff          1 1 mdpd/rhosum  0.75
pair_coeff          1 1 mdpd         -40 25 4.5 1.0 0.75
mass                1 1.0

compute             mythermo all temp
thermo              100
thermo_modify       temp mythermo
thermo_modify       flush yes

velocity            all create 1.0 3365 loop local dist gaussian
comm_modify         vel yes
fix         mvv     all mvv/dpd 0.65

#compute     clt      all aggregate/atom 1.

dump        mydump  all atom 100 threads.lammpstrj

#dump cluster       all custom 2500 dump.cl c_clt


timestep            0.01
run                 160000

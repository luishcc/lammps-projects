log dipole2.log

units		lj
atom_style	hybrid sphere dipole mdpd
dimension	3
boundary p p p

neighbor	0.5 bin
neigh_modify	every 1 delay 0 check yes
comm_modify vel yes cutoff 2.5

variable Radius equal 3
variable WaveNumber equal 2
variable WaveLength equal 2*PI*v_Radius*v_WaveNumber
print ${WaveLength}


region     mdpd     block -18 18 -18 18 0 ${WaveLength} units box
create_box          2 mdpd

region     tube     cylinder z 0 0 v_Radius INF INF

create_atoms  1 random $(round(6.1*PI*v_Radius^2*v_WaveLength)) 2021 tube
create_atoms  2 random $(round(6.1*PI*v_Radius^2*v_WaveLength*0.1)) 2022 tube

group mnp type 2
mass		* 1.0



set		group mnp dipole/random 98934 1.

# velocity	all create 1 87287 mom yes

pair_style hybrid/overlay mdpd/rhosum mdpd 1.0 1.0 65689 lj/sf/dipole/sf 3.0
pair_coeff  *  *   mdpd/rhosum  0.75


pair_coeff  1  1   mdpd  -50.0  25.0  4.5  1.0  0.75
pair_coeff  1  2   mdpd  -70.0  25.0  4.5  1.0  0.75
pair_coeff  2  2   mdpd  -50.0  25.0  4.5  1.0  0.75

pair_coeff	2  2 lj/sf/dipole/sf 0.0001 .6

dump		1 all custom 100 dump.varying-thread3 id type x y z mux muy muz fx fy fz

min_style cg
minimize 0 0 10000 100000

# fix		1 all nvt/sphere  temp 1 1 1 update dipole
fix		1 all nve/sphere  update dipole
# fix         2 all mvv/dpd 0.65 

thermo_style	custom step temp press
thermo		200

timestep	0.0001
run 1000

timestep	0.001
run 1000


variable Amp equal 00
variable alpha equal 2*PI/(zhi-zlo)*2
variable Bx equal 0
variable By equal 0
variable Bz atom v_Amp*sin(v_alpha*z)

variable dxBz equal 0
variable dyBz equal 0
variable dzBz atom v_Amp*v_alpha*cos(v_alpha*z)

fix field all efield v_Bx v_By v_Bz

compute muz all property/atom muz
variable xxx atom C_muz*v_dzBz
fix fieldforce all addforce 0 0 v_xxx


timestep	0.001
run 100000

# timestep	0.01
# run 10000

